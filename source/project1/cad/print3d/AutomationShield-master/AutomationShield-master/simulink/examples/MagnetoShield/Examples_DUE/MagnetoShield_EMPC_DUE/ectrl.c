/* The function for evaluation of a piecewise affine control law associated
   to a given state X using sequential search.

  Usage:
   unsigned long region = ectrl( double *X, double *U)


   where X is a vector of dimension MPT_DOMAIN and U is a vector of dimension 
   MPT_RANGE for PWA functions ( 1 for PWQ functions). The output variable "region"
   indicates index of a region where the point X is located. If "region" index is
   smaller than 1 (region < 1), there is no control law associated to
   a given state.

   Please note that all code in this file is provided under the terms of the
   GNU General Public License, which implies that if you include it directly
   into your commercial application, you will need to comply with the license.
   If you feel this is not a good solution for you or your company, feel free 
   to contact the author:
       michal.kvasnica@stuba.sk
    to re-license this specific piece of code to you free of charge.
*/

/* Copyright (C) 2005 by Michal Kvasnica (michal.kvasnica@stuba.sk) 
   Revised in 2012-2013 by Martin Herceg (herceg@control.ee.ethz.ch)    
*/


/*  This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
*/ 

/* Generated on 29-Nov-2020 16:05:51 by MPT @version@ */ 

#include <float.h>

#define MPT_NR 16
#define MPT_DOMAIN 4
#define MPT_RANGE 2
#define MPT_ABSTOL 1.000000e-08

static double MPT_A[] = {
4.40473430737666e-03,	-9.99685745959276e-01,	-2.31842776578636e-02,	8.45558460485547e-03,	-7.07106781186548e-01,	
7.07106781186548e-01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-9.86385583207744e-01,	
-1.56203715608689e-01,	5.14186782206386e-02,	-4.45495787504589e-01,	8.95282976311678e-01,	1.34625757811907e-03,	
-2.88500784232842e-04,	0.00000000000000e+00,	9.86385583207744e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
-3.93384235169941e-03,	9.99689774931507e-01,	2.31035496587225e-02,	-8.43236472832137e-03,	4.40473430737666e-03,	
-9.99685745959276e-01,	-2.31842776578636e-02,	8.45558460485547e-03,	-7.07106781186548e-01,	7.07106781186548e-01,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.32047301954116e-02,	9.64168373900227e-01,	-2.52400939293427e-01,	
8.06148107661060e-02,	-4.47396287312129e-01,	8.94334926742318e-01,	1.24051460028076e-03,	-2.49061563992801e-04,	
1.32047301954116e-02,	-9.64168373900227e-01,	2.52400939293427e-01,	-8.06148107661060e-02,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	-4.40473430737666e-03,	
9.99685745959276e-01,	2.31842776578636e-02,	-8.45558460485547e-03,	-3.68578060870484e-03,	9.99691805367671e-01,	
2.30610207945438e-02,	-8.42013194340474e-03,	0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	
5.14186782206386e-02,	-4.46794999760587e-01,	8.94635969499624e-01,	8.34256314890219e-04,	-1.19510690395988e-04,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	9.86385583207744e-01,	
1.56203715608689e-01,	-5.14186782206386e-02,	-5.13635430083256e-03,	9.99808949939217e-01,	-1.82081739597820e-02,	
4.91364294455937e-03,	1.32047301954116e-02,	-9.64168373900227e-01,	2.52400939293427e-01,	-8.06148107661060e-02,	
4.58160591368048e-03,	-9.99684173541672e-01,	-2.32145985550003e-02,	8.46430572971215e-03,	3.93384235169941e-03,	
-9.99689774931507e-01,	-2.31035496587225e-02,	8.43236472832137e-03,	-7.07106781186547e-01,	7.07106781186547e-01,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	
5.14186782206386e-02,	-4.45495787504589e-01,	8.95282976311678e-01,	1.34625757811907e-03,	-2.88500784232842e-04,	
0.00000000000000e+00,	9.86385583207744e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	-3.93384235169941e-03,	
9.99689774931507e-01,	2.31035496587225e-02,	-8.43236472832137e-03,	-7.07106781186548e-01,	7.07106781186548e-01,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	
5.14186782206386e-02,	-4.45495787504589e-01,	8.95282976311678e-01,	1.34625757811907e-03,	-2.88500784232842e-04,	
0.00000000000000e+00,	-9.96232457994904e-01,	-8.11813111714098e-02,	3.05038416256640e-02,	7.07106781186548e-01,	
-7.07106781186548e-01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	9.86385583207745e-01,	
1.56203715608689e-01,	-5.14186782206386e-02,	4.45495787504589e-01,	-8.95282976311678e-01,	-1.34625757811907e-03,	
2.88500784232842e-04,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
-4.40473430737666e-03,	9.99685745959276e-01,	2.31842776578636e-02,	-8.45558460485547e-03,	-3.93384235169941e-03,	
9.99689774931507e-01,	2.31035496587225e-02,	-8.43236472832137e-03,	4.45495787504589e-01,	-8.95282976311678e-01,	
-1.34625757811907e-03,	2.88500784232842e-04,	-7.07106781186548e-01,	7.07106781186548e-01,	0.00000000000000e+00,	
0.00000000000000e+00,	-4.46794999760587e-01,	8.94635969499624e-01,	8.34256314890219e-04,	-1.19510690395988e-04,	
-4.47016172297631e-01,	8.94525253979336e-01,	1.04012589371752e-03,	-1.72730152514147e-04,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	-4.45495787504589e-01,	8.95282976311678e-01,	1.34625757811907e-03,	-2.88500784232842e-04,	
4.47396287312129e-01,	-8.94334926742318e-01,	-1.24051460028076e-03,	2.49061563992801e-04,	0.00000000000000e+00,	
-9.86385583207744e-01,	-1.56203715608689e-01,	5.14186782206386e-02,	4.46794999760587e-01,	-8.94635969499624e-01,	
-8.34256314890219e-04,	1.19510690395988e-04,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
9.86385583207744e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	-5.13635430083256e-03,	9.99808949939217e-01,	
-1.82081739597820e-02,	4.91364294455937e-03,	-1.32047301954116e-02,	9.64168373900227e-01,	-2.52400939293427e-01,	
8.06148107661059e-02,	4.58160591368048e-03,	-9.99684173541672e-01,	-2.32145985550003e-02,	8.46430572971215e-03,	
3.68578060870484e-03,	-9.99691805367671e-01,	-2.30610207945438e-02,	8.42013194340474e-03,	-2.36657863034686e-02,	
7.99630963607153e-01,	-5.71189597007804e-01,	1.83773493380838e-01,	2.36657863034686e-02,	-7.99630963607153e-01,	
5.71189597007804e-01,	-1.83773493380838e-01,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	-3.68578060870484e-03,	9.99691805367671e-01,	
2.30610207945438e-02,	-8.42013194340474e-03,	-4.58160591368048e-03,	9.99684173541672e-01,	2.32145985550003e-02,	
-8.46430572971215e-03,	3.93384235169941e-03,	-9.99689774931507e-01,	-2.31035496587225e-02,	8.43236472832137e-03,	
4.40473430737666e-03,	-9.99685745959276e-01,	-2.31842776578636e-02,	8.45558460485547e-03,	-7.07106781186547e-01,	
7.07106781186547e-01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-9.86385583207744e-01,	
-1.56203715608689e-01,	5.14186782206386e-02,	-4.45495787504589e-01,	8.95282976311678e-01,	1.34625757811907e-03,	
-2.88500784232842e-04,	7.07106781186547e-01,	-7.07106781186547e-01,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	9.86385583207744e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	4.45495787504589e-01,	
-8.95282976311678e-01,	-1.34625757811907e-03,	2.88500784232842e-04,	0.00000000000000e+00,	9.96232457994904e-01,	
8.11813111714098e-02,	-3.05038416256640e-02,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	3.93384235169941e-03,	-9.99689774931507e-01,	-2.31035496587225e-02,	8.43236472832137e-03,	
0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	5.14186782206386e-02,	7.07106781186547e-01,	
-7.07106781186547e-01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	9.86385583207745e-01,	
1.56203715608689e-01,	-5.14186782206386e-02,	4.45495787504589e-01,	-8.95282976311678e-01,	-1.34625757811907e-03,	
2.88500784232842e-04,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	-3.93384235169941e-03,	9.99689774931507e-01,	2.31035496587225e-02,	-8.43236472832137e-03,	
-4.58160591368048e-03,	9.99684173541672e-01,	2.32145985550003e-02,	-8.46430572971215e-03,	0.00000000000000e+00,	
-9.86385583207744e-01,	-1.56203715608689e-01,	5.14186782206386e-02,	5.13635430083256e-03,	-9.99808949939217e-01,	
1.82081739597820e-02,	-4.91364294455937e-03,	4.46794999760587e-01,	-8.94635969499624e-01,	-8.34256314890219e-04,	
1.19510690395988e-04,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	-5.13635430083256e-03,	
9.99808949939217e-01,	-1.82081739597820e-02,	4.91364294455937e-03,	0.00000000000000e+00,	9.86385583207745e-01,	
1.56203715608689e-01,	-5.14186782206386e-02,	-2.36657863034686e-02,	7.99630963607153e-01,	-5.71189597007804e-01,	
1.83773493380838e-01,	3.68578060870484e-03,	-9.99691805367671e-01,	-2.30610207945438e-02,	8.42013194340474e-03,	
4.40473430737666e-03,	-9.99685745959276e-01,	-2.31842776578636e-02,	8.45558460485547e-03,	-1.32047301954116e-02,	
9.64168373900227e-01,	-2.52400939293427e-01,	8.06148107661060e-02,	7.07106781186548e-01,	-7.07106781186548e-01,	
0.00000000000000e+00,	0.00000000000000e+00,	1.32047301954116e-02,	-9.64168373900227e-01,	2.52400939293427e-01,	
-8.06148107661060e-02,	4.47396287312129e-01,	-8.94334926742318e-01,	-1.24051460028076e-03,	2.49061563992802e-04,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
-4.40473430737666e-03,	9.99685745959276e-01,	2.31842776578636e-02,	-8.45558460485547e-03,	5.13635430083256e-03,	
-9.99808949939217e-01,	1.82081739597820e-02,	-4.91364294455937e-03,	0.00000000000000e+00,	-9.86385583207744e-01,	
-1.56203715608689e-01,	5.14186782206386e-02,	-4.46794999760587e-01,	8.94635969499624e-01,	8.34256314890219e-04,	
-1.19510690395988e-04,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	
1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	9.86385583207744e-01,	
1.56203715608689e-01,	-5.14186782206386e-02,	1.32047301954116e-02,	-9.64168373900227e-01,	2.52400939293427e-01,	
-8.06148107661060e-02,	4.45495787504589e-01,	-8.95282976311678e-01,	-1.34625757811907e-03,	2.88500784232842e-04,	
7.07106781186548e-01,	-7.07106781186548e-01,	0.00000000000000e+00,	0.00000000000000e+00,	4.46794999760587e-01,	
-8.94635969499624e-01,	-8.34256314890219e-04,	1.19510690395988e-04,	4.47016172297631e-01,	-8.94525253979336e-01,	
-1.04012589371752e-03,	1.72730152514147e-04,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	-4.45495787504589e-01,	
8.95282976311678e-01,	1.34625757811907e-03,	-2.88500784232842e-04,	-4.47396287312129e-01,	8.94334926742318e-01,	
1.24051460028076e-03,	-2.49061563992801e-04,	3.93384235169941e-03,	-9.99689774931507e-01,	-2.31035496587225e-02,	
8.43236472832137e-03,	0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	5.14186782206386e-02,	
7.07106781186548e-01,	-7.07106781186548e-01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
9.86385583207745e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	4.45495787504589e-01,	-8.95282976311678e-01,	
-1.34625757811907e-03,	2.88500784232842e-04,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.00000000000000e+00,	
1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	1.00000000000000e+00,	-4.40473430737666e-03,	9.99685745959276e-01,	2.31842776578636e-02,	
-8.45558460485547e-03,	5.13635430083256e-03,	-9.99808949939217e-01,	1.82081739597820e-02,	-4.91364294455937e-03,	
0.00000000000000e+00,	-9.86385583207744e-01,	-1.56203715608689e-01,	5.14186782206386e-02,	4.46794999760587e-01,	
-8.94635969499624e-01,	-8.34256314890219e-04,	1.19510690395988e-04,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	1.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	9.86385583207744e-01,	1.56203715608689e-01,	-5.14186782206386e-02,	
-1.32047301954116e-02,	9.64168373900227e-01,	-2.52400939293427e-01,	8.06148107661059e-02 };

static double MPT_B[] = {
-7.78726403904716e-04,	7.07106781186548e+03,	1.53063610886055e+03,	4.45495788002815e+03,	1.53063913454266e+03,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	
-5.97919735311322e-04,	1.15551490662171e-03,	7.07106781186548e+03,	3.15433032458594e+03,	4.47417480636408e+03,	
3.15433189088899e+03,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	7.78726403904716e-04,	-1.32312370713523e-03,	1.53063892261098e+03,	4.47300556158500e+03,	
1.00000000000000e+04,	1.00000000000000e+04,	-1.53063610886055e+03,	4.74015803245923e+02,	-3.15433032458593e+03,	
-1.29580882119495e-03,	5.97919735311322e-04,	7.07106781186547e+03,	1.53063610886055e+03,	4.45495788002815e+03,	
1.53063913454266e+03,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	1.47142299327404e-03,	7.07106781186548e+03,	1.53063892261098e+03,	4.45495787076160e+03,	
7.59624940259013e+02,	7.07106781186548e+03,	1.53063632079223e+03,	4.45495787933019e+03,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	
-1.15551490662171e-03,	-1.26529350651029e-03,	-4.45495787076160e+03,	7.07106781186548e+03,	4.47300556158499e+03,	
4.47306922724572e+03,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	4.45495788002815e+03,	
-4.47417480636408e+03,	-1.53063632079223e+03,	4.47300556158499e+03,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	1.53063913454266e+03,	-4.74018301645578e+02,	-3.15433189088898e+03,	1.11428086595855e-03,	
1.32312370713523e-03,	6.77209780655166e+03,	6.77209780655166e+03,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	1.53867433572334e-03,	1.29580882119495e-03,	-1.47142299327404e-03,	
-1.34376031642131e-03,	7.07106781186548e+03,	1.53063610886055e+03,	4.45495788002815e+03,	7.07106781186548e+03,	
1.53063913454266e+03,	4.45495787006364e+03,	7.59625228408920e+02,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.26529350651029e-03,	
1.53063892261098e+03,	7.07106781186548e+03,	1.53063632079223e+03,	4.45495787933019e+03,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	8.04049222075078e-04,	
-1.11428086595855e-03,	-1.53063632079223e+03,	4.74018301645578e+02,	4.47300556158499e+03,	1.00000000000000e+04,	
1.00000000000000e+04,	-4.74015599738264e+02,	1.53063913454266e+03,	-6.77209780655166e+03,	-1.53867433572334e-03,	
5.90480994105116e-04,	3.15433201847252e+03,	7.07106781186548e+03,	3.15433019700240e+03,	4.47417480656885e+03,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	
1.34376031642131e-03,	-4.74018505153237e+02,	1.53063892261098e+03,	4.47300556158500e+03,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	-1.53063610886055e+03,	-3.15433201847252e+03,	4.45495787933019e+03,	
7.07106781186548e+03,	4.47300556158499e+03,	4.47306922764830e+03,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	-4.45495787006364e+03,	-4.47417480656885e+03,	-8.04049222075078e-04,	1.53063892261098e+03,	
7.07106781186548e+03,	1.53063632079223e+03,	4.45495787933019e+03,	1.00000000000000e+04,	1.00000000000000e+04,	
1.00000000000000e+04,	1.00000000000000e+04,	1.00000000000000e+04,	-5.90480994105116e-04,	4.74015599738264e+02,	
-1.53063632079223e+03,	4.47300556158499e+03,	1.00000000000000e+04,	1.00000000000000e+04,	1.53063913454266e+03,	
-3.15433019700240e+03 };

static int MPT_NC[] = {
11,	12,	7,	12,	15,	
9,	8,	10,	15,	12,	
8,	12,	8,	9,	11,	
7 };


static double MPT_F[] = {
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-2.27724135732468e+01,	5.16836105463594e+03,	
1.19862384965575e+02,	-4.37152518604526e+01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	3.50559016573658e+03,	5.55144173446425e+02,	-1.82740721046691e+02,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-1.90101054666215e+01,	4.83095313851133e+03,	
1.11646801371160e+02,	-4.07490002107378e+01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
-4.80756874185759e+05,	9.66144815003197e+05,	1.45281415281339e+03,	-3.11335682891260e+02,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	3.50559016573658e+03,	
5.55144173446425e+02,	-1.82740721046691e+02,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.90101054666215e+01,	4.14791274727363e+03,	9.63225504791006e+01,	-3.51202935510219e+01,	
-1.28792477788656e+01,	3.49322974715960e+03,	8.05822788651737e+01,	-2.94225232434434e+01,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	-1.90101054666215e+01,	4.83095313851133e+03,	1.11646801371160e+02,	-4.07490002107378e+01,	
0.00000000000000e+00,	3.50559016573658e+03,	5.55144173446425e+02,	-1.82740721046691e+02,	-1.90101054666215e+01,	
3.70038211377588e+03,	-6.73900761234366e+01,	1.81858308696215e+01,	-2.27724135732468e+01,	5.16836105463594e+03,	
1.19862384965575e+02,	-4.37152518604526e+01,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	3.50559016573658e+03,	5.55144173446425e+02,	-1.82740721046691e+02,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	-4.80756874185759e+05,	
9.66144815003197e+05,	1.45281415281339e+03,	-3.11335682891260e+02,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	3.50559016573658e+03,	5.55144173446425e+02,	-1.82740721046691e+02,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	0.00000000000000e+00 };


static double MPT_G[] = {
5.37660000000000e+00,	-4.62340000000000e+00,	1.35059559368952e+00,	-4.62340000000000e+00,	5.43984855951962e+06,	
-4.62340000000000e+00,	5.37660000000000e+00,	-1.73398140803931e+00,	-4.62340000000000e+00,	-4.62340000000000e+00,	
-4.80756874185759e+09,	-4.62340000000000e+00,	-5.43984855951962e+06,	-4.62340000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	5.37660000000000e+00,	5.37660000000000e+00,	-4.62340000000000e+00,	1.49107049844306e+00,	
-5.43984855951962e+06,	1.75437939678541e+06,	-1.57062167864149e+00,	5.37660000000000e+00,	5.43984855951962e+06,	
5.37660000000000e+00,	4.80756874185759e+09,	5.37660000000000e+00,	-4.62340000000000e+00,	5.37660000000000e+00,	
-5.43984855951962e+06,	5.37660000000000e+00 };


static double MPT_HTB[] = {
5.18758855344690e+03,	-1.00099008691149e+05,	-1.33223542210977e+03,	4.63345226493387e+02,	-1.00099008691149e+05,	
1.29602256294511e+07,	2.76822977570035e+05,	-1.00427290220247e+05,	-1.33223542210977e+03,	2.76822977570035e+05,	
6.49549080475030e+03,	-2.32762007202755e+03,	4.63345226493387e+02,	-1.00427290220247e+05,	-2.32762007202755e+03,	
8.57757342733349e+02,	5.10837638072359e+03,	-8.21212433023628e+04,	-9.15302894936840e+02,	3.11284924677982e+02,	
-8.21212433023628e+04,	8.88004404545148e+06,	1.82197178292305e+05,	-6.59161243602430e+04,	-9.15302894936840e+02,	
1.82197178292305e+05,	4.30097036378212e+03,	-1.52725210156385e+03,	3.11284924677982e+02,	-6.59161243602430e+04,	
-1.52725210156385e+03,	5.65853528038615e+02,	5.18758855344690e+03,	-8.79050700551635e+04,	5.98792925497538e+02,	
-1.72304987418863e+02,	-8.79050700551635e+04,	9.30236110552335e+06,	7.16426055358994e+04,	-3.06058914148560e+04,	
5.98792925497538e+02,	7.16426055358994e+04,	3.32420544754955e+04,	-1.07707993940698e+04,	-1.72304987418863e+02,	
-3.06058914148560e+04,	-1.07707993940698e+04,	3.51816748486837e+03,	5.13758855344690e+03,	-8.73927321610331e+04,	
-1.03858423335863e+03,	3.56168019396126e+02,	-8.73927321610331e+04,	9.73123636425554e+06,	2.02198713416648e+05,	
-7.31908255981803e+04,	-1.03858423335863e+03,	2.02198713416648e+05,	4.77087039165112e+03,	-1.69816578660478e+03,	
3.56168019396126e+02,	-7.31908255981803e+04,	-1.69816578660478e+03,	6.28018268309963e+02,	5.18758855344690e+03,	
-1.00099008691149e+05,	-1.33223542210977e+03,	4.63345226493387e+02,	-1.00099008691149e+05,	1.29602256294511e+07,	
2.76822977570035e+05,	-1.00427290220247e+05,	-1.33223542210977e+03,	2.76822977570035e+05,	6.49549080475030e+03,	
-2.32762007202755e+03,	4.63345226493387e+02,	-1.00427290220247e+05,	-2.32762007202755e+03,	8.57757342733349e+02,	
3.53007331378332e+10,	-7.05654285747092e+10,	-9.78807363093898e+07,	1.96519149804359e+07,	-7.05654285747092e+10,	
1.41067390677099e+11,	1.95841716561661e+08,	-3.93490216167684e+07,	-9.78807363093898e+07,	1.95841716561661e+08,	
2.75696488106901e+05,	-5.60160844735802e+04,	1.96519149804359e+07,	-3.93490216167684e+07,	-5.60160844735802e+04,	
1.15057278412023e+04,	5.18758855344690e+03,	-8.79050700551635e+04,	5.98792925497538e+02,	-1.72304987418863e+02,	
-8.79050700551635e+04,	9.30236110552335e+06,	7.16426055358994e+04,	-3.06058914148560e+04,	5.98792925497538e+02,	
7.16426055358994e+04,	3.32420544754955e+04,	-1.07707993940698e+04,	-1.72304987418863e+02,	-3.06058914148560e+04,	
-1.07707993940698e+04,	3.51816748486837e+03,	5.08758855344691e+03,	-7.64829748360235e+04,	-7.85238583466717e+02,	
2.63795324219114e+02,	-7.64829748360235e+04,	7.35078026644349e+06,	1.46919922223296e+05,	-5.30355518414143e+04,	
-7.85238583466717e+02,	1.46919922223296e+05,	3.48719002526801e+03,	-1.23012137676703e+03,	2.63795324219114e+02,	
-5.30355518414143e+04,	-1.23012137676703e+03,	4.57363972024657e+02,	5.18758855344690e+03,	-1.00099008691149e+05,	
-1.33223542210977e+03,	4.63345226493387e+02,	-1.00099008691149e+05,	1.29602256294511e+07,	2.76822977570035e+05,	
-1.00427290220247e+05,	-1.33223542210977e+03,	2.76822977570035e+05,	6.49549080475030e+03,	-2.32762007202755e+03,	
4.63345226493387e+02,	-1.00427290220247e+05,	-2.32762007202755e+03,	8.57757342733349e+02,	5.13758855344690e+03,	
-8.73927321610331e+04,	-1.03858423335863e+03,	3.56168019396126e+02,	-8.73927321610331e+04,	9.73123636425554e+06,	
2.02198713416648e+05,	-7.31908255981803e+04,	-1.03858423335863e+03,	2.02198713416648e+05,	4.77087039165112e+03,	
-1.69816578660478e+03,	3.56168019396126e+02,	-7.31908255981803e+04,	-1.69816578660478e+03,	6.28018268309963e+02,	
5.13758855344690e+03,	-7.81723988706898e+04,	4.21544892229754e+02,	-1.24472978013254e+02,	-7.81723988706898e+04,	
7.40786333782166e+06,	1.06144542053699e+05,	-3.99165558076051e+04,	4.21544892229754e+02,	1.06144542053699e+05,	
3.26137171695495e+04,	-1.06012368021820e+04,	-1.24472978013254e+02,	-3.99165558076051e+04,	-1.06012368021820e+04,	
3.47240946239280e+03,	5.10837638072359e+03,	-8.21212433023628e+04,	-9.15302894936840e+02,	3.11284924677982e+02,	
-8.21212433023628e+04,	8.88004404545148e+06,	1.82197178292305e+05,	-6.59161243602430e+04,	-9.15302894936840e+02,	
1.82197178292305e+05,	4.30097036378212e+03,	-1.52725210156385e+03,	3.11284924677982e+02,	-6.59161243602430e+04,	
-1.52725210156385e+03,	5.65853528038615e+02,	5.18758855344690e+03,	-8.79050700551635e+04,	5.98792925497538e+02,	
-1.72304987418863e+02,	-8.79050700551635e+04,	9.30236110552335e+06,	7.16426055358994e+04,	-3.06058914148560e+04,	
5.98792925497538e+02,	7.16426055358994e+04,	3.32420544754955e+04,	-1.07707993940698e+04,	-1.72304987418863e+02,	
-3.06058914148560e+04,	-1.07707993940698e+04,	3.51816748486837e+03,	3.53007331378332e+10,	-7.05654285747092e+10,	
-9.78807363093898e+07,	1.96519149804359e+07,	-7.05654285747092e+10,	1.41067390677099e+11,	1.95841716561661e+08,	
-3.93490216167684e+07,	-9.78807363093898e+07,	1.95841716561661e+08,	2.75696488106901e+05,	-5.60160844735802e+04,	
1.96519149804359e+07,	-3.93490216167684e+07,	-5.60160844735802e+04,	1.15057278412023e+04,	5.18758855344690e+03,	
-1.00099008691149e+05,	-1.33223542210977e+03,	4.63345226493387e+02,	-1.00099008691149e+05,	1.29602256294511e+07,	
2.76822977570035e+05,	-1.00427290220247e+05,	-1.33223542210977e+03,	2.76822977570035e+05,	6.49549080475030e+03,	
-2.32762007202755e+03,	4.63345226493387e+02,	-1.00427290220247e+05,	-2.32762007202755e+03,	8.57757342733349e+02,	
5.18758855344690e+03,	-8.79050700551635e+04,	5.98792925497538e+02,	-1.72304987418863e+02,	-8.79050700551635e+04,	
9.30236110552335e+06,	7.16426055358994e+04,	-3.06058914148560e+04,	5.98792925497538e+02,	7.16426055358994e+04,	
3.32420544754955e+04,	-1.07707993940698e+04,	-1.72304987418863e+02,	-3.06058914148560e+04,	-1.07707993940698e+04,	
3.51816748486837e+03 };


static double MPT_FTB[] = {
1.30834698019237e+01,	-2.30862996856749e+03,	-5.40404173750466e+01,	1.96707186496955e+01,	-1.49248531096297e+01,	
4.04805791065680e+03,	9.33811272173433e+01,	-3.40956898308650e+01,	3.78442052598644e+07,	-2.76326333393678e+09,	
7.23370929444787e+08,	-2.31038806083772e+08,	2.82828520306756e+01,	-6.17118104227661e+03,	-1.43306750570167e+02,	
5.22512653873233e+01,	-5.64850653632449e+01,	1.34804433599679e+04,	3.12132914083103e+02,	-1.13877094651962e+02,	
7.06048004754737e+14,	-1.41137378318600e+15,	-1.95768915208843e+12,	3.93050691947917e+11,	-3.78442539013620e+07,	
2.76327280217082e+09,	-7.23371101876983e+08,	2.31038852616184e+08,	0.00000000000000e+00,	0.00000000000000e+00,	
0.00000000000000e+00,	0.00000000000000e+00,	6.56870706475802e+01,	-1.56765479450628e+04,	-3.62982615793401e+02,	
1.32428859087628e+02,	-2.43207488149808e+01,	5.30666935067918e+03,	1.23231118287786e+02,	-4.49314623352585e+01,	
-2.86155622285789e+07,	9.66876371889039e+08,	-6.90655752904271e+08,	2.22210315278303e+08,	1.73562670825010e+01,	
-4.70752869369670e+03,	-1.08593885148758e+02,	3.96502327171840e+01,	3.78442578634653e+07,	-2.76327357340778e+09,	
7.23371115922483e+08,	-2.31038856406491e+08,	-7.06048004787048e+14,	1.41137378324993e+15,	1.95768915216281e+12,	
-3.93050691960351e+11,	-3.88146451758839e+00,	1.12525383472575e+02,	3.19071566474836e+00,	-1.11895421402952e+00,	
-3.78442012977612e+07,	2.76326256269982e+09,	-7.23370915399287e+08,	2.31038802293465e+08 };


static double MPT_GTB[] = {
5.15470469562403e+00,	2.67886630693969e+00,	4.52009126928289e+12,	3.99959859494552e+00,	8.13021040969172e+00,	
3.53040725252315e+18,	4.52009575824490e+12,	0.00000000000000e+00,	1.09949764466516e+01,	2.95749411460699e+00,	
4.09425200828841e+12,	3.62279331829091e+00,	4.52009612389527e+12,	3.53040725284630e+18,	5.04631582755517e+00,	
4.52009090363460e+12 };



/* main evaluation function using sequential search */
static unsigned long ectrl( double *X, double *U)

{
    int ix, jx, ic, nc, isinside;
    unsigned long ireg, abspos, iregmin, region;
    double hx, sx, obj, objmin;

    abspos = 0;
    region = 0;
    iregmin = 0;

   /* initialize values of the tie-break function */
    obj = 0;
    objmin = DBL_MAX;


    for (ireg=0; ireg<MPT_NR; ireg++) {

        isinside = 1;
        nc = MPT_NC[ireg];
        for (ic=0; ic<nc; ic++) {
            hx = 0;
            for (ix=0; ix<MPT_DOMAIN; ix++) {
                hx += MPT_A[abspos*MPT_DOMAIN+ic*MPT_DOMAIN+ix]*X[ix];
            }
            if ((hx - MPT_B[abspos+ic]) > MPT_ABSTOL) {
                /* constraint is violated, continue with next region */
                isinside = 0;
                break;
            } 
        }
        if (isinside==1) {
            /* state belongs to this region, evaluate the tie-breaking function */
            obj = 0;
            for (ix=0; ix<MPT_DOMAIN; ix++) {
                sx = 0;
                for (jx=0; jx<MPT_DOMAIN; jx++) {
                    sx += MPT_HTB[ireg*MPT_DOMAIN*MPT_DOMAIN + ix*MPT_DOMAIN + jx]*X[jx];
                }
                obj += sx*X[ix];
            }
            for (ix=0; ix<MPT_DOMAIN; ix++) {
                obj += MPT_FTB[ireg*MPT_DOMAIN + ix]*X[ix];
            }
            obj += MPT_GTB[ireg];
            if (obj<objmin) {
                objmin = obj;
                region = ireg + 1;
                iregmin = ireg;
            }
        }
        abspos = abspos + MPT_NC[ireg];
    }
    for (ix=0; ix<MPT_RANGE; ix++) {
        sx = 0;
        for (jx=0; jx<MPT_DOMAIN; jx++) {
            sx += MPT_F[iregmin*MPT_DOMAIN*MPT_RANGE + ix*MPT_DOMAIN + jx]*X[jx];
        }
        U[ix] = sx + MPT_G[iregmin*MPT_RANGE + ix];
    }
    return region;
}


